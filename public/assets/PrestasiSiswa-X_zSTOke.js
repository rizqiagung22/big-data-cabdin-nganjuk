import{_ as P,a as $,r as g}from"./DataTable.vue_vue_type_script_setup_true_lang-DY7X4hUp.js";import{g as D,a as S,d as F,u as U}from"./prestasi-siswa.service-DKKtvWjf.js";import{u as A}from"./tahun.strore-VJK20NBN.js";import{_ as B}from"./FilterBpopp.vue_vue_type_script_setup_true_lang-CVw3jcYQ.js";import{u as G}from"./admin.bos.store-CpXNwLIh.js";import{r as v,a as f}from"./admin.bpopp.store-Cc77VqiR.js";import{d as I,r as y,l as b,c as V,b as e,e as s,w as c,F as j,i as E,t as d,u as o}from"./index-BQYtnNF3.js";import"./axios.plugin-BErkf-r6.js";import"./global.service-BlmddMAm.js";const N={class:"bg-white rounded-lg shadow overflow-hidden"},z={class:"text-gray-500"},L={class:"flex items-center space-x-2"},R={class:"text-gray-500 w-[80px] truncate w-[80px] truncate"},T={class:"flex gap-2"},q=["onClick"],H=["onClick"],J={class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},K=["for"],M=["id","onChange"],O={class:"flex items-center space-x-2"},Q={class:"text-gray-500 w-[80px] truncate w-[80px] truncate"},W={class:"flex gap-2"},X=["onClick"],Y=["onClick"],Z={class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},aa=["for"],ea=["id","onChange"],ta={class:"flex items-center space-x-2"},sa={class:"text-gray-500 w-[80px] truncate w-[80px] truncate"},na={class:"flex gap-2"},oa=["onClick"],ia=["onClick"],la={class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},ra=["for"],ca=["id","onChange"],da={class:"flex items-center space-x-2"},pa={class:"text-gray-500 w-[80px] truncate w-[80px] truncate"},ua={class:"flex gap-2"},ha=["onClick"],_a=["onClick"],ga={class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},va=["for"],fa=["id","onChange"],xa={class:"flex items-center space-x-2"},ka={class:"text-gray-500 w-[80px] truncate w-[80px] truncate"},ma={class:"flex gap-2"},wa=["onClick"],ya=["onClick"],ba={class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},Ca=["for"],Pa=["id","onChange"],ja=I({__name:"PrestasiSiswa",setup($a){A();const k=G(),x=y([]),C=[{key:"lembaga",label:"Satuan Lembaga"},{key:"kecamatan",label:"kecamatan"},{key:"kabupaten",label:"kabupaten"},{key:"provinsi",label:"provinsi"},{key:"nasional",label:"nasional"},{key:"internasional",label:"internasional"}],i=y({currentPage:1,itemsPerPage:10,totalItems:0}),m=()=>{i.value={currentPage:1,itemsPerPage:10,totalItems:0}},p=async(l=!1)=>{try{l&&m();const n=await D({search:k.search,tahun_id:k.tahun,page:i.value.currentPage,size:i.value.itemsPerPage});x.value=[...n.data.data.data],i.value.totalItems=n.data.data.total}catch(n){console.log(n),x.value=[],m()}};b(()=>i.value.currentPage,async()=>{await p()}),b(()=>i.value.itemsPerPage,async(l,n)=>{l!==n&&(i.value.currentPage=1,await p())});const u=async(l,n)=>{try{await S(l.id,l.name_file)}catch(a){a.status==404?alert("Gagal mengunduh file. File tidak ditemukan."):alert("Gagal mengunduh file. Silakan coba lagi.")}},h=async(l,n)=>{try{await F(l.id),await p()}catch(a){a.status==404?alert("Gagal mengahapus file. File tidak ditemukan."):alert("Gagal mengahapus file. Silakan coba lagi.")}},_=async(l,n,a,t)=>{console.log("upload");try{const r=l.target;if(r.files&&r.files.length>0){const w=new FormData;w.append("report_file",r.files[0]),await U(n.id,w),await p()}}catch{alert("Gagal upload file")}finally{const r=document.getElementById(t);r&&(r.value="")}};return(l,n)=>(E(),V(j,null,[n[2]||(n[2]=e("div",{class:"mb-4"},[e("h1",{class:"text-2xl font-bold text-gray-800"},"Prestasi Siswa")],-1)),s(B,{class:"mb-4",onSubmit:p}),e("div",N,[s(P,{class:"my-4 flex justify-end px-2",modelValue:i.value.itemsPerPage,"onUpdate:modelValue":n[0]||(n[0]=a=>i.value.itemsPerPage=a)},null,8,["modelValue"]),s($,{columns:C,data:x.value,"total-items":i.value.totalItems,"items-per-page":i.value.itemsPerPage,currentPage:i.value.currentPage,"onUpdate:currentPage":n[1]||(n[1]=a=>i.value.currentPage=a)},{"cell(lembaga)":c(({item:a})=>[e("span",z,d(a.jenjang),1)]),"cell(kecamatan)":c(({item:a})=>[e("div",L,[e("span",R,d(a.kecamatan.name_file??""),1),e("div",T,[e("div",{onClick:t=>u(a.kecamatan,"kecamatan"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[s(o(v),{class:"h-5 w-5"})],8,q),e("div",{onClick:t=>h(a.kecamatan,"kecamatan"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[s(o(g),{class:"h-5 w-5"})],8,H),e("div",J,[e("label",{for:`kecamatan${a.kecamatan.id}`},[s(o(f),{class:"h-5 w-5"})],8,K),e("input",{type:"file",class:"hidden",id:`kecamatan${a.kecamatan.id}`,onChange:t=>_(t,a.kecamatan,"kecamatan",`kecamatan${a.kecamatan.id}`)},null,40,M)])])])]),"cell(kabupaten)":c(({item:a})=>[e("div",O,[e("span",Q,d(a.kabupaten.name_file??""),1),e("div",W,[e("div",{onClick:t=>u(a.kabupaten,"kabupaten"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[s(o(v),{class:"h-5 w-5"})],8,X),e("div",{onClick:t=>h(a.kabupaten,"kabupaten"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[s(o(g),{class:"h-5 w-5"})],8,Y),e("div",Z,[e("label",{for:`kabupaten${a.kabupaten.id}`},[s(o(f),{class:"h-5 w-5"})],8,aa),e("input",{type:"file",class:"hidden",id:`kabupaten${a.kabupaten.id}`,onChange:t=>_(t,a.kabupaten,"kabupaten",`kabupaten${a.kabupaten.id}`)},null,40,ea)])])])]),"cell(provinsi)":c(({item:a})=>[e("div",ta,[e("span",sa,d(a.provinsi.name_file??""),1),e("div",na,[e("div",{onClick:t=>u(a.provinsi,"provinsi"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[s(o(v),{class:"h-5 w-5"})],8,oa),e("div",{onClick:t=>h(a.provinsi,"provinsi"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[s(o(g),{class:"h-5 w-5"})],8,ia),e("div",la,[e("label",{for:`provinsi${a.provinsi.id}`},[s(o(f),{class:"h-5 w-5"})],8,ra),e("input",{type:"file",class:"hidden",id:`provinsi${a.provinsi.id}`,onChange:t=>_(t,a.provinsi,"provinsi",`provinsi${a.provinsi.id}`)},null,40,ca)])])])]),"cell(nasional)":c(({item:a})=>[e("div",da,[e("span",pa,d(a.nasional.name_file??""),1),e("div",ua,[e("div",{onClick:t=>u(a.nasional,"nasional"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[s(o(v),{class:"h-5 w-5"})],8,ha),e("div",{onClick:t=>h(a.nasional,"nasional"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[s(o(g),{class:"h-5 w-5"})],8,_a),e("div",ga,[e("label",{for:`nasional${a.nasional.id}`},[s(o(f),{class:"h-5 w-5"})],8,va),e("input",{type:"file",class:"hidden",id:`nasional${a.nasional.id}`,onChange:t=>_(t,a.nasional,"nasional",`nasional${a.nasional.id}`)},null,40,fa)])])])]),"cell(internasional)":c(({item:a})=>[e("div",xa,[e("span",ka,d(a.internasional.name_file??""),1),e("div",ma,[e("div",{onClick:t=>u(a.internasional,"internasional"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[s(o(v),{class:"h-5 w-5"})],8,wa),e("div",{onClick:t=>h(a.internasional,"internasional"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[s(o(g),{class:"h-5 w-5"})],8,ya),e("div",ba,[e("label",{for:`internasional${a.internasional.id}`},[s(o(f),{class:"h-5 w-5"})],8,Ca),e("input",{type:"file",class:"hidden",id:`internasional${a.internasional.id}`,onChange:t=>_(t,a.internasional,"internasional",`internasional${a.internasional.id}`)},null,40,Pa)])])])]),_:1},8,["data","total-items","items-per-page","currentPage"])])],64))}});export{ja as default};
