import{d as g,r as u,o as b,c as d,a as x,u as a,b as t,e as r,w as h,T as v,f as y,g as k,h as _,i as n,j as w,k as S,_ as C}from"./index-DisDyyuw.js";import{u as A}from"./axios.plugin-Cr9Ns81A.js";import{u as L}from"./login.service-Cy9nFaE2.js";import{S as T,H as j,r as M,a as B}from"./Header-C6K1r44r.js";const H={key:0,class:"flex items-center justify-center h-screen bg-gray-100"},N={key:1,class:"flex h-screen bg-gray-100"},V={class:"flex-1 flex flex-col overflow-hidden"},$={class:"flex-1 overflow-y-auto p-6 bg-gray-50"},z={class:"bg-white rounded-lg shadow-xl w-full max-w-md m-4 transform transition-all text-center p-6 sm:p-8"},I={class:"mx-auto flex h-16 w-16 items-center justify-center rounded-full bg-red-100"},D=g({__name:"Layout",setup(E){const s=A(),c=k(),m=u(!0),l=()=>{s.logout(),c.replace("/login")},o=u(!0);return b(async()=>{const i=localStorage.getItem("auth_token");if(i&&!s.isAuthenticated)try{s.setLoading(!0),s.updateToken(i);const e=await L();console.log(e.data.user),s.setUser(e.data.user)}catch(e){console.error("Failed to log in:",e)}finally{s.setLoading(!1)}else s.setLoading(!1)}),(i,e)=>{const f=_("router-view");return a(s).isLoading?(n(),d("div",H,[...e[2]||(e[2]=[t("div",{class:"text-center"},[t("div",{class:"w-16 h-16 border-4 border-blue-500 border-dashed rounded-full animate-spin mx-auto"}),t("p",{class:"mt-4 text-gray-600"},"Memuat data...")],-1)])])):a(s).isAuthenticated&&a(s).user&&a(s).user?.role==="superadmin"?(n(),d("div",N,[r(T,{"is-collapsed":o.value,onToggle:e[0]||(e[0]=p=>o.value=!o.value)},null,8,["is-collapsed"]),t("div",V,[r(j,{user:a(s).user,"is-sidebar-collapsed":o.value,onToggleSidebar:e[1]||(e[1]=p=>o.value=!o.value)},null,8,["user","is-sidebar-collapsed"]),t("main",$,[r(f)])])])):(n(),x(y,{key:2,to:"body"},[r(v,{name:"modal-fade"},{default:h(()=>[m.value?(n(),d("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",onClick:S(l,["self"])},[t("div",z,[t("div",I,[r(a(M),{class:"h-10 w-10 text-red-600","aria-hidden":"true"})]),t("button",{onClick:l,class:"absolute top-4 right-4 p-1 rounded-full text-gray-400 hover:bg-gray-200 hover:text-gray-600 transition-colors"},[r(a(B),{class:"h-6 w-6"})]),e[3]||(e[3]=t("div",{class:"mt-4"},[t("h3",{class:"text-xl font-semibold text-gray-900"},"Akses Ditolak"),t("p",{class:"mt-2 text-sm text-gray-600"}," Maaf, Anda tidak memiliki izin yang cukup untuk mengakses halaman ini. Silakan hubungi administrator jika Anda merasa ini adalah sebuah kesalahan. ")],-1)),t("div",{class:"mt-6"},[t("button",{onClick:l,type:"button",class:"w-full inline-flex justify-center rounded-md border border-transparent bg-purple-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 sm:text-sm transition-colors"}," Kembali ke Halaman Awal ")])])])):w("",!0)]),_:1})]))}}}),U=C(D,[["__scopeId","data-v-681dc95e"]]);export{U as default};
