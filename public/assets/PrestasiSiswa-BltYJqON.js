import{_ as P,a as $,r as g}from"./DataTable.vue_vue_type_script_setup_true_lang-JQNF7XXJ.js";import{u as D,_ as S,g as F,a as U,d as A,b as G}from"./FilterPrestasiSiswa.vue_vue_type_script_setup_true_lang-uE4DL6F5.js";import{r as v,a as x}from"./FileSaver.min-CLWXV6HW.js";import{d as I,r as y,l as b,c as V,b as e,e as s,w as c,F as B,i as j,t as d,u as i}from"./index-DisDyyuw.js";import"./axios.plugin-Cr9Ns81A.js";import"./global.service-WSUCU1y3.js";const E={class:"bg-white rounded-lg shadow overflow-hidden"},N={class:"text-gray-500"},z={class:"flex items-center space-x-2"},L={class:"text-gray-500 w-[80px] truncate w-[80px] truncate"},R={class:"flex gap-2"},q=["onClick"],H=["onClick"],J={class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},K=["for"],M=["id","onChange"],O={class:"flex items-center space-x-2"},Q={class:"text-gray-500 w-[80px] truncate w-[80px] truncate"},T={class:"flex gap-2"},W=["onClick"],X=["onClick"],Y={class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},Z=["for"],aa=["id","onChange"],ea={class:"flex items-center space-x-2"},ta={class:"text-gray-500 w-[80px] truncate w-[80px] truncate"},sa={class:"flex gap-2"},na=["onClick"],ia=["onClick"],oa={class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},la=["for"],ra=["id","onChange"],ca={class:"flex items-center space-x-2"},da={class:"text-gray-500 w-[80px] truncate w-[80px] truncate"},pa={class:"flex gap-2"},ha=["onClick"],_a=["onClick"],ua={class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},ga=["for"],va=["id","onChange"],xa={class:"flex items-center space-x-2"},fa={class:"text-gray-500 w-[80px] truncate w-[80px] truncate"},ka={class:"flex gap-2"},ma=["onClick"],wa=["onClick"],ya={class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},ba=["for"],Ca=["id","onChange"],Ga=I({__name:"PrestasiSiswa",setup(Pa){const k=D(),f=y([]),C=[{key:"lembaga",label:"Satuan Lembaga"},{key:"kecamatan",label:"kecamatan"},{key:"kabupaten",label:"kabupaten"},{key:"provinsi",label:"provinsi"},{key:"nasional",label:"nasional"},{key:"internasional",label:"internasional"}],o=y({currentPage:1,itemsPerPage:10,totalItems:0}),m=()=>{o.value={currentPage:1,itemsPerPage:10,totalItems:0}},p=async(l=!1)=>{try{l&&m();const n=await F({search:k.search,tahun_id:k.tahun,page:o.value.currentPage,size:o.value.itemsPerPage});f.value=[...n.data.data.data],o.value.totalItems=n.data.data.total}catch(n){console.log(n),f.value=[],m()}};b(()=>o.value.currentPage,async()=>{await p()}),b(()=>o.value.itemsPerPage,async(l,n)=>{l!==n&&(o.value.currentPage=1,await p())});const h=async(l,n)=>{try{await U(l.id,l.name_file)}catch(a){a.status==404?alert("Gagal mengunduh file. File tidak ditemukan."):alert("Gagal mengunduh file. Silakan coba lagi.")}},_=async(l,n)=>{try{await A(l.id),await p()}catch(a){a.status==404?alert("Gagal mengahapus file. File tidak ditemukan."):alert("Gagal mengahapus file. Silakan coba lagi.")}},u=async(l,n,a,t)=>{console.log("upload");try{const r=l.target;if(r.files&&r.files.length>0){const w=new FormData;w.append("report_file",r.files[0]),await G(n.id,w),await p()}}catch{alert("Gagal upload file")}finally{const r=document.getElementById(t);r&&(r.value="")}};return(l,n)=>(j(),V(B,null,[n[2]||(n[2]=e("div",{class:"mb-4"},[e("h1",{class:"text-2xl font-bold text-gray-800"},"Prestasi Siswa")],-1)),s(S,{class:"mb-4",onSubmit:p}),e("div",E,[s(P,{class:"my-4 flex justify-end px-2",modelValue:o.value.itemsPerPage,"onUpdate:modelValue":n[0]||(n[0]=a=>o.value.itemsPerPage=a)},null,8,["modelValue"]),s($,{columns:C,data:f.value,"total-items":o.value.totalItems,"items-per-page":o.value.itemsPerPage,currentPage:o.value.currentPage,"onUpdate:currentPage":n[1]||(n[1]=a=>o.value.currentPage=a)},{"cell(lembaga)":c(({item:a})=>[e("span",N,d(a.jenjang),1)]),"cell(kecamatan)":c(({item:a})=>[e("div",z,[e("span",L,d(a.kecamatan.name_file??""),1),e("div",R,[e("div",{onClick:t=>h(a.kecamatan,"kecamatan"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[s(i(v),{class:"h-5 w-5"})],8,q),e("div",{onClick:t=>_(a.kecamatan,"kecamatan"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[s(i(g),{class:"h-5 w-5"})],8,H),e("div",J,[e("label",{for:`kecamatan${a.kecamatan.id}`},[s(i(x),{class:"h-5 w-5"})],8,K),e("input",{type:"file",class:"hidden",id:`kecamatan${a.kecamatan.id}`,onChange:t=>u(t,a.kecamatan,"kecamatan",`kecamatan${a.kecamatan.id}`)},null,40,M)])])])]),"cell(kabupaten)":c(({item:a})=>[e("div",O,[e("span",Q,d(a.kabupaten.name_file??""),1),e("div",T,[e("div",{onClick:t=>h(a.kabupaten,"kabupaten"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[s(i(v),{class:"h-5 w-5"})],8,W),e("div",{onClick:t=>_(a.kabupaten,"kabupaten"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[s(i(g),{class:"h-5 w-5"})],8,X),e("div",Y,[e("label",{for:`kabupaten${a.kabupaten.id}`},[s(i(x),{class:"h-5 w-5"})],8,Z),e("input",{type:"file",class:"hidden",id:`kabupaten${a.kabupaten.id}`,onChange:t=>u(t,a.kabupaten,"kabupaten",`kabupaten${a.kabupaten.id}`)},null,40,aa)])])])]),"cell(provinsi)":c(({item:a})=>[e("div",ea,[e("span",ta,d(a.provinsi.name_file??""),1),e("div",sa,[e("div",{onClick:t=>h(a.provinsi,"provinsi"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[s(i(v),{class:"h-5 w-5"})],8,na),e("div",{onClick:t=>_(a.provinsi,"provinsi"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[s(i(g),{class:"h-5 w-5"})],8,ia),e("div",oa,[e("label",{for:`provinsi${a.provinsi.id}`},[s(i(x),{class:"h-5 w-5"})],8,la),e("input",{type:"file",class:"hidden",id:`provinsi${a.provinsi.id}`,onChange:t=>u(t,a.provinsi,"provinsi",`provinsi${a.provinsi.id}`)},null,40,ra)])])])]),"cell(nasional)":c(({item:a})=>[e("div",ca,[e("span",da,d(a.nasional.name_file??""),1),e("div",pa,[e("div",{onClick:t=>h(a.nasional,"nasional"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[s(i(v),{class:"h-5 w-5"})],8,ha),e("div",{onClick:t=>_(a.nasional,"nasional"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[s(i(g),{class:"h-5 w-5"})],8,_a),e("div",ua,[e("label",{for:`nasional${a.nasional.id}`},[s(i(x),{class:"h-5 w-5"})],8,ga),e("input",{type:"file",class:"hidden",id:`nasional${a.nasional.id}`,onChange:t=>u(t,a.nasional,"nasional",`nasional${a.nasional.id}`)},null,40,va)])])])]),"cell(internasional)":c(({item:a})=>[e("div",xa,[e("span",fa,d(a.internasional.name_file??""),1),e("div",ka,[e("div",{onClick:t=>h(a.internasional,"internasional"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[s(i(v),{class:"h-5 w-5"})],8,ma),e("div",{onClick:t=>_(a.internasional,"internasional"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[s(i(g),{class:"h-5 w-5"})],8,wa),e("div",ya,[e("label",{for:`internasional${a.internasional.id}`},[s(i(x),{class:"h-5 w-5"})],8,ba),e("input",{type:"file",class:"hidden",id:`internasional${a.internasional.id}`,onChange:t=>u(t,a.internasional,"internasional",`internasional${a.internasional.id}`)},null,40,Ca)])])])]),_:1},8,["data","total-items","items-per-page","currentPage"])])],64))}});export{Ga as default};
