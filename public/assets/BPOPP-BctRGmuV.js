import{_ as A,r as x,a as U}from"./DataTable.vue_vue_type_script_setup_true_lang-AtLWOcLb.js";import{g as S,a as G,d as I,u as V,b as E}from"./admin.service-iZasMADy.js";import{u as j,_ as N}from"./FilterBpopp.vue_vue_type_script_setup_true_lang-CMFmQ-Rx.js";import{u as O}from"./axios.plugin-CVK5CeTo.js";import{r as m,a as w}from"./FileSaver.min-CR4blg5B.js";import{d as R,r as D,l as B,c as n,i as o,b as s,e as r,w as y,t as b,j as p,u as t,F as K}from"./index-D0E--Iw5.js";import"./global.service-CsoV2rCN.js";const z={class:"bg-white rounded-lg shadow overflow-hidden"},L={class:"text-gray-500"},T={class:"flex items-center space-x-2"},q={class:"text-gray-500 w-[80px] truncate w-[80px] truncate"},H={class:"flex gap-2"},J=["onClick"],M=["onClick"],Q={key:1,class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},W=["for"],X=["id","onChange"],Y=["id","onChange"],Z={class:"flex items-center space-x-2"},aa={class:"text-gray-500 w-[80px] truncate"},ea={class:"flex gap-2"},sa=["onClick"],ta=["onClick"],la={key:1,class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},na=["for"],oa=["id","onChange"],ra=["id","onChange"],ia={class:"flex items-center space-x-2"},ca={class:"text-gray-500 w-[80px] truncate"},da={class:"flex gap-2"},ua=["onClick"],pa=["onClick"],ga={key:1,class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},_a=["for"],ha=["id","onChange"],ya=["id","onChange"],ba={class:"flex items-center space-x-2"},fa={class:"text-gray-500 w-[80px] truncate"},va={class:"flex gap-2"},ka=["onClick"],xa=["onClick"],ma={key:1,class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},wa=["for"],Ca=["id","onChange"],$a=["id","onChange"],Pa={class:"flex items-center space-x-2"},Da={class:"text-gray-500 w-[80px] truncate"},Ba={class:"flex gap-2"},Fa=["onClick"],Aa=["onClick"],Ua=["onClick"],Sa=["for"],Ga=["id","onChange"],Ia=["id","onChange"],La=R({__name:"BPOPP",setup(Va){const C=j(),u=O(),$=D([]),F=[{key:"lembaga",label:"Lembaga"},{key:"pagu",label:"Pagu"},{key:"rkas",label:"RKAS"},{key:"realisasi",label:"Realisasi"},{key:"usulan_per_bulan",label:"Usulan Per Bulan"},{key:"penyerapan_tiap_bulan",label:"Penyerapan Tiap Bulan"}],c=D({currentPage:1,itemsPerPage:10,totalItems:0}),P=()=>{c.value={currentPage:1,itemsPerPage:10,totalItems:0}},_=async(d=!1)=>{try{d&&P();const l=await S({search:C.search,tahun_id:C.tahun,page:c.value.currentPage,size:c.value.itemsPerPage});$.value=[...l.data.data.data],c.value.totalItems=l.data.data.total}catch(l){console.log(l),$.value=[],P()}};B(()=>c.value.currentPage,async()=>{await _()}),B(()=>c.value.itemsPerPage,async(d,l)=>{d!==l&&(c.value.currentPage=1,await _())});const h=async(d,l)=>{try{await G(d.laporan?.[l]?.id,d.laporan?.[l]?.name_file)}catch(a){a.status==404?alert("Gagal mengunduh file. File tidak ditemukan."):alert("Gagal mengunduh file. Silakan coba lagi.")}},f=async(d,l)=>{try{await I(d.laporan?.[l]?.id),await _()}catch(a){a.status==404?alert("Gagal mengahapus file. File tidak ditemukan."):alert("Gagal mengahapus file. Silakan coba lagi.")}},v=async(d,l,a,e)=>{try{const i=d.target;if(i.files&&i.files.length>0){const g=new FormData;g.append("report_file",i.files[0]),await V(l.laporan?.[a]?.id,g),await _()}}catch{alert("Gagal upload file")}finally{const i=document.getElementById(e);i&&(i.value="")}},k=async(d,l,a,e)=>{try{const i=d.target;if(C.tahun&&i.files&&i.files.length>0){const g=new FormData;g.append("tahun_id",C.tahun.toString()),g.append("lembaga_id",l.lembaga.id),g.append("jenis_laporan",a),g.append("report_file",i.files[0]),await E(g),await _()}}catch{alert("Gagal menambahkan file")}finally{const i=document.getElementById(e);i&&(i.value="")}};return(d,l)=>(o(),n(K,null,[l[2]||(l[2]=s("div",{class:"mb-4"},[s("h1",{class:"text-2xl font-bold text-gray-800"},"BPOPP"),s("p",{class:"text-gray-600"},"Kelola data Bantuan Penunjang Operasinal Penyelenggaran Pendidikan")],-1)),r(N,{class:"mb-4",onSubmit:_}),s("div",z,[r(A,{class:"my-4 flex justify-end px-2",modelValue:c.value.itemsPerPage,"onUpdate:modelValue":l[0]||(l[0]=a=>c.value.itemsPerPage=a)},null,8,["modelValue"]),r(U,{columns:F,data:$.value,"total-items":c.value.totalItems,"items-per-page":c.value.itemsPerPage,currentPage:c.value.currentPage,"onUpdate:currentPage":l[1]||(l[1]=a=>c.value.currentPage=a)},{"cell(lembaga)":y(({item:a})=>[s("span",L,b(a.lembaga.nama),1)]),"cell(pagu)":y(({item:a})=>[s("div",T,[s("span",q,b(a.laporan?.pagu?.name_file??""),1),s("div",H,[s("div",{onClick:e=>h(a,"pagu"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[r(t(m),{class:"h-5 w-5"})],8,J),t(u).user.role!="user"?(o(),n("div",{key:0,onClick:e=>f(a,"pagu"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[r(t(x),{class:"h-5 w-5"})],8,M)):p("",!0),t(u).user.role!="user"?(o(),n("div",Q,[s("label",{for:`pagu${a.lembaga.id}`},[r(t(w),{class:"h-5 w-5"})],8,W),a.laporan?.pagu?(o(),n("input",{key:0,type:"file",class:"hidden",id:`pagu${a.lembaga.id}`,onChange:e=>v(e,a,"pagu",`pagu${a.lembaga.id}`)},null,40,X)):(o(),n("input",{key:1,type:"file",class:"hidden",id:`pagu${a.lembaga.id}`,onChange:e=>k(e,a,"pagu",`pagu${a.lembaga.id}`)},null,40,Y))])):p("",!0)])])]),"cell(rkas)":y(({item:a})=>[s("div",Z,[s("span",aa,b(a.laporan?.rkas?.name_file??""),1),s("div",ea,[s("div",{onClick:e=>h(a,"rkas"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[r(t(m),{class:"h-5 w-5"})],8,sa),t(u).user.role!="user"?(o(),n("div",{key:0,onClick:e=>f(a,"rkas"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[r(t(x),{class:"h-5 w-5"})],8,ta)):p("",!0),t(u).user.role!="user"?(o(),n("div",la,[s("label",{for:`rkas${a.lembaga.id}`},[r(t(w),{class:"h-5 w-5"})],8,na),a.laporan?.rkas?(o(),n("input",{key:0,type:"file",class:"hidden",id:`rkas${a.lembaga.id}`,onChange:e=>v(e,a,"rkas",`rkas${a.lembaga.id}`)},null,40,oa)):(o(),n("input",{key:1,type:"file",class:"hidden",id:`rkas${a.lembaga.id}`,onChange:e=>k(e,a,"rkas",`rkas${a.lembaga.id}`)},null,40,ra))])):p("",!0)])])]),"cell(realisasi)":y(({item:a})=>[s("div",ia,[s("span",ca,b(a.laporan?.realisasi?.name_file??""),1),s("div",da,[s("div",{onClick:e=>h(a,"realisasi"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[r(t(m),{class:"h-5 w-5"})],8,ua),t(u).user.role!="user"?(o(),n("div",{key:0,onClick:e=>f(a,"realisasi"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[r(t(x),{class:"h-5 w-5"})],8,pa)):p("",!0),t(u).user.role!="user"?(o(),n("div",ga,[s("label",{for:`realisasi${a.lembaga.id}`},[r(t(w),{class:"h-5 w-5"})],8,_a),a.laporan?.realisasi?(o(),n("input",{key:0,type:"file",class:"hidden",id:`realisasi${a.lembaga.id}`,onChange:e=>v(e,a,"realisasi",`realisasi${a.lembaga.id}`)},null,40,ha)):(o(),n("input",{key:1,type:"file",class:"hidden",id:`realisasi${a.lembaga.id}`,onChange:e=>k(e,a,"realisasi",`realisasi${a.lembaga.id}`)},null,40,ya))])):p("",!0)])])]),"cell(usulan_per_bulan)":y(({item:a})=>[s("div",ba,[s("span",fa,b(a.laporan?.["usulan per bulan"]?.name_file??""),1),s("div",va,[s("div",{onClick:e=>h(a,"usulan per bulan"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[r(t(m),{class:"h-5 w-5"})],8,ka),t(u).user.role!="user"?(o(),n("div",{key:0,onClick:e=>f(a,"usulan per bulan"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[r(t(x),{class:"h-5 w-5"})],8,xa)):p("",!0),t(u).user.role!="user"?(o(),n("div",ma,[s("label",{for:`usulan_per_bulan${a.lembaga.id}`},[r(t(w),{class:"h-5 w-5"})],8,wa),a.laporan?.["usulan per bulan"]?(o(),n("input",{key:0,type:"file",class:"hidden",id:`usulan_per_bulan${a.lembaga.id}`,onChange:e=>v(e,a,"usulan per bulan",`usulan_per_bulan${a.lembaga.id}`)},null,40,Ca)):(o(),n("input",{key:1,type:"file",class:"hidden",id:`usulan_per_bulan${a.lembaga.id}`,onChange:e=>k(e,a,"usulan per bulan",`usulan_per_bulan${a.lembaga.id}`)},null,40,$a))])):p("",!0)])])]),"cell(penyerapan_tiap_bulan)":y(({item:a})=>[s("div",Pa,[s("span",Da,b(a.laporan?.["penyerapan tiap bulan"]?.name_file??""),1),s("div",Ba,[s("div",{onClick:e=>h(a,"penyerapan tiap bulan"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[r(t(m),{class:"h-5 w-5"})],8,Fa),t(u).user.role!="user"?(o(),n("div",{key:0,onClick:e=>f(a,"penyerapan tiap bulan"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[r(t(x),{class:"h-5 w-5"})],8,Aa)):p("",!0),t(u).user.role!="user"?(o(),n("div",{key:1,onClick:e=>h(a,"penyerapan tiap bulan"),class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},[s("label",{for:`penyerapan_tiap_bulan${a.lembaga.id}`},[r(t(w),{class:"h-5 w-5"})],8,Sa),a.laporan?.["penyerapan tiap bulan"]?(o(),n("input",{key:0,type:"file",class:"hidden",id:`penyerapan_tiap_bulan${a.lembaga.id}`,onChange:e=>v(e,a,"penyerapan tiap bulan",`penyerapan_tiap_bulan${a.lembaga.id}`)},null,40,Ga)):(o(),n("input",{key:1,type:"file",class:"hidden",id:`penyerapan_tiap_bulan${a.lembaga.id}`,onChange:e=>k(e,a,"penyerapan tiap bulan",`penyerapan_tiap_bulan${a.lembaga.id}`)},null,40,Ia))],8,Ua)):p("",!0)])])]),_:1},8,["data","total-items","items-per-page","currentPage"])])],64))}});export{La as default};
