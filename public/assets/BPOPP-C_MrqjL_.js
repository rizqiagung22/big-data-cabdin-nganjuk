import{_ as D,a as F,r as v}from"./DataTable.vue_vue_type_script_setup_true_lang-DY7X4hUp.js";import{g as U,a as A,d as S,u as G,b as I}from"./admin.service-B0ASV2DS.js";import{u as E}from"./tahun.strore-VJK20NBN.js";import{_ as V}from"./FilterBpopp.vue_vue_type_script_setup_true_lang-CVw3jcYQ.js";import{u as j}from"./admin.bos.store-CpXNwLIh.js";import{r as x,a as k}from"./admin.bpopp.store-Cc77VqiR.js";import{d as O,r as $,l as P,c,b as e,e as n,w as _,F as R,i as d,t as h,u as o}from"./index-BQYtnNF3.js";import"./axios.plugin-BErkf-r6.js";import"./global.service-BlmddMAm.js";const K={class:"bg-white rounded-lg shadow overflow-hidden"},N={class:"text-gray-500"},T={class:"flex items-center space-x-2"},z={class:"text-gray-500 w-[80px] truncate w-[80px] truncate"},L={class:"flex gap-2"},q=["onClick"],H=["onClick"],J={class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},M=["for"],Q=["id","onChange"],W=["id","onChange"],X={class:"flex items-center space-x-2"},Y={class:"text-gray-500 w-[80px] truncate"},Z={class:"flex gap-2"},aa=["onClick"],ea=["onClick"],la={class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},ta=["for"],na=["id","onChange"],sa=["id","onChange"],oa={class:"flex items-center space-x-2"},ia={class:"text-gray-500 w-[80px] truncate"},ra={class:"flex gap-2"},ca=["onClick"],da=["onClick"],pa={class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},ua=["for"],ga=["id","onChange"],_a=["id","onChange"],ha={class:"flex items-center space-x-2"},ba={class:"text-gray-500 w-[80px] truncate"},fa={class:"flex gap-2"},ya=["onClick"],va=["onClick"],xa={class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},ka=["for"],ma=["id","onChange"],wa=["id","onChange"],Ca={class:"flex items-center space-x-2"},$a={class:"text-gray-500 w-[80px] truncate"},Pa={class:"flex gap-2"},Ba=["onClick"],Da=["onClick"],Fa=["onClick"],Ua=["for"],Aa=["id","onChange"],Sa=["id","onChange"],za=O({__name:"BPOPP",setup(Ga){E();const m=j(),w=$([]),B=[{key:"lembaga",label:"Lembaga"},{key:"pagu",label:"Pagu"},{key:"rkas",label:"RKAS"},{key:"realisasi",label:"Realisasi"},{key:"usulan_per_bulan",label:"Usulan Per Bulan"},{key:"penyerapan_tiap_bulan",label:"Penyerapan Tiap Bulan"}],i=$({currentPage:1,itemsPerPage:10,totalItems:0}),C=()=>{i.value={currentPage:1,itemsPerPage:10,totalItems:0}},u=async(r=!1)=>{try{r&&C();const t=await U({search:m.search,tahun_id:m.tahun,page:i.value.currentPage,size:i.value.itemsPerPage});w.value=[...t.data.data.data],i.value.totalItems=t.data.data.total}catch(t){console.log(t),w.value=[],C()}};P(()=>i.value.currentPage,async()=>{await u()}),P(()=>i.value.itemsPerPage,async(r,t)=>{r!==t&&(i.value.currentPage=1,await u())});const g=async(r,t)=>{try{await A(r.laporan?.[t]?.id,r.laporan?.[t]?.name_file)}catch(a){a.status==404?alert("Gagal mengunduh file. File tidak ditemukan."):alert("Gagal mengunduh file. Silakan coba lagi.")}},b=async(r,t)=>{try{await S(r.laporan?.[t]?.id),await u()}catch(a){a.status==404?alert("Gagal mengahapus file. File tidak ditemukan."):alert("Gagal mengahapus file. Silakan coba lagi.")}},f=async(r,t,a,l)=>{try{const s=r.target;if(s.files&&s.files.length>0){const p=new FormData;p.append("report_file",s.files[0]),await G(t.laporan?.[a]?.id,p),await u()}}catch{alert("Gagal upload file")}finally{const s=document.getElementById(l);s&&(s.value="")}},y=async(r,t,a,l)=>{try{const s=r.target;if(m.tahun&&s.files&&s.files.length>0){const p=new FormData;p.append("tahun_id",m.tahun.toString()),p.append("lembaga_id",t.lembaga.id),p.append("jenis_laporan",a),p.append("report_file",s.files[0]),await I(p),await u()}}catch{alert("Gagal menambahkan file")}finally{const s=document.getElementById(l);s&&(s.value="")}};return(r,t)=>(d(),c(R,null,[t[2]||(t[2]=e("div",{class:"mb-4"},[e("h1",{class:"text-2xl font-bold text-gray-800"},"BPOPP"),e("p",{class:"text-gray-600"},"Kelola data Bantuan Penunjang Operasinal Penyelenggaran Pendidikan")],-1)),n(V,{class:"mb-4",onSubmit:u}),e("div",K,[n(D,{class:"my-4 flex justify-end px-2",modelValue:i.value.itemsPerPage,"onUpdate:modelValue":t[0]||(t[0]=a=>i.value.itemsPerPage=a)},null,8,["modelValue"]),n(F,{columns:B,data:w.value,"total-items":i.value.totalItems,"items-per-page":i.value.itemsPerPage,currentPage:i.value.currentPage,"onUpdate:currentPage":t[1]||(t[1]=a=>i.value.currentPage=a)},{"cell(lembaga)":_(({item:a})=>[e("span",N,h(a.lembaga.nama),1)]),"cell(pagu)":_(({item:a})=>[e("div",T,[e("span",z,h(a.laporan?.pagu?.name_file??""),1),e("div",L,[e("div",{onClick:l=>g(a,"pagu"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[n(o(x),{class:"h-5 w-5"})],8,q),e("div",{onClick:l=>b(a,"pagu"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[n(o(v),{class:"h-5 w-5"})],8,H),e("div",J,[e("label",{for:`pagu${a.lembaga.id}`},[n(o(k),{class:"h-5 w-5"})],8,M),a.laporan?.pagu?(d(),c("input",{key:0,type:"file",class:"hidden",id:`pagu${a.lembaga.id}`,onChange:l=>f(l,a,"pagu",`pagu${a.lembaga.id}`)},null,40,Q)):(d(),c("input",{key:1,type:"file",class:"hidden",id:`pagu${a.lembaga.id}`,onChange:l=>y(l,a,"pagu",`pagu${a.lembaga.id}`)},null,40,W))])])])]),"cell(rkas)":_(({item:a})=>[e("div",X,[e("span",Y,h(a.laporan?.rkas?.name_file??""),1),e("div",Z,[e("div",{onClick:l=>g(a,"rkas"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[n(o(x),{class:"h-5 w-5"})],8,aa),e("div",{onClick:l=>b(a,"rkas"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[n(o(v),{class:"h-5 w-5"})],8,ea),e("div",la,[e("label",{for:`rkas${a.lembaga.id}`},[n(o(k),{class:"h-5 w-5"})],8,ta),a.laporan?.rkas?(d(),c("input",{key:0,type:"file",class:"hidden",id:`rkas${a.lembaga.id}`,onChange:l=>f(l,a,"rkas",`rkas${a.lembaga.id}`)},null,40,na)):(d(),c("input",{key:1,type:"file",class:"hidden",id:`rkas${a.lembaga.id}`,onChange:l=>y(l,a,"rkas",`rkas${a.lembaga.id}`)},null,40,sa))])])])]),"cell(realisasi)":_(({item:a})=>[e("div",oa,[e("span",ia,h(a.laporan?.realisasi?.name_file??""),1),e("div",ra,[e("div",{onClick:l=>g(a,"realisasi"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[n(o(x),{class:"h-5 w-5"})],8,ca),e("div",{onClick:l=>b(a,"realisasi"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[n(o(v),{class:"h-5 w-5"})],8,da),e("div",pa,[e("label",{for:`realisasi${a.lembaga.id}`},[n(o(k),{class:"h-5 w-5"})],8,ua),a.laporan?.realisasi?(d(),c("input",{key:0,type:"file",class:"hidden",id:`realisasi${a.lembaga.id}`,onChange:l=>f(l,a,"realisasi",`realisasi${a.lembaga.id}`)},null,40,ga)):(d(),c("input",{key:1,type:"file",class:"hidden",id:`realisasi${a.lembaga.id}`,onChange:l=>y(l,a,"realisasi",`realisasi${a.lembaga.id}`)},null,40,_a))])])])]),"cell(usulan_per_bulan)":_(({item:a})=>[e("div",ha,[e("span",ba,h(a.laporan?.["usulan per bulan"]?.name_file??""),1),e("div",fa,[e("div",{onClick:l=>g(a,"usulan per bulan"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[n(o(x),{class:"h-5 w-5"})],8,ya),e("div",{onClick:l=>b(a,"usulan per bulan"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[n(o(v),{class:"h-5 w-5"})],8,va),e("div",xa,[e("label",{for:`usulan_per_bulan${a.lembaga.id}`},[n(o(k),{class:"h-5 w-5"})],8,ka),a.laporan?.["usulan per bulan"]?(d(),c("input",{key:0,type:"file",class:"hidden",id:`usulan_per_bulan${a.lembaga.id}`,onChange:l=>f(l,a,"usulan per bulan",`usulan_per_bulan${a.lembaga.id}`)},null,40,ma)):(d(),c("input",{key:1,type:"file",class:"hidden",id:`usulan_per_bulan${a.lembaga.id}`,onChange:l=>y(l,a,"usulan per bulan",`usulan_per_bulan${a.lembaga.id}`)},null,40,wa))])])])]),"cell(penyerapan_tiap_bulan)":_(({item:a})=>[e("div",Ca,[e("span",$a,h(a.laporan?.["penyerapan tiap bulan"]?.name_file??""),1),e("div",Pa,[e("div",{onClick:l=>g(a,"penyerapan tiap bulan"),class:"text-gray-400 hover:text-green-500 transition-colors",title:"Download"},[n(o(x),{class:"h-5 w-5"})],8,Ba),e("div",{onClick:l=>b(a,"penyerapan tiap bulan"),class:"text-gray-400 hover:text-red-500 transition-colors",title:"Delete"},[n(o(v),{class:"h-5 w-5"})],8,Da),e("div",{onClick:l=>g(a,"penyerapan tiap bulan"),class:"text-gray-400 hover:text-blue-500 transition-colors",title:"Upload"},[e("label",{for:`penyerapan_tiap_bulan${a.lembaga.id}`},[n(o(k),{class:"h-5 w-5"})],8,Ua),a.laporan?.["penyerapan tiap bulan"]?(d(),c("input",{key:0,type:"file",class:"hidden",id:`penyerapan_tiap_bulan${a.lembaga.id}`,onChange:l=>f(l,a,"penyerapan tiap bulan",`penyerapan_tiap_bulan${a.lembaga.id}`)},null,40,Aa)):(d(),c("input",{key:1,type:"file",class:"hidden",id:`penyerapan_tiap_bulan${a.lembaga.id}`,onChange:l=>y(l,a,"penyerapan tiap bulan",`penyerapan_tiap_bulan${a.lembaga.id}`)},null,40,Sa))],8,Fa)])])]),_:1},8,["data","total-items","items-per-page","currentPage"])])],64))}});export{za as default};
